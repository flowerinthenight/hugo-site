<!doctype html><html data-paige="Paige theme from https://github.com/willfaught/paige" lang=en><head><meta charset=utf-8><meta content="#0d6efd" name=msapplication-TileColor><meta content="/browserconfig.xml" name=msapplication-config><meta content="https://github.com/willfaught/paige" name=theme><meta content="#0d6efd" name=theme-color><meta content="width=device-width,initial-scale=1" name=viewport><meta property="og:url" content="https://flowerinthenight.com/categories/code/"><meta property="og:site_name" content="flowerinthenight"><meta property="og:title" content="Code"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Code"><title>Code · Categories · About</title>
<link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon.ico rel="shortcut icon"><link href=/favicon.png rel=icon type=image/png><link href=/favicon.svg rel=icon type=image/svg+xml><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link color=#0d6efd href=/safari-pinned-tab.svg rel=mask-icon><link href=/site.webmanifest rel=manifest><link crossorigin=anonymous href=/css/paige/bootstrap/6186ad141d391e4c0c10d2e9cb4eaeaadf75e809-paige.min.1c5bb4860fb7f3809f4195b145668aade87f2e92cf701992599678b1d166f0f0.css integrity="sha256-HFu0hg+384CfQZWxRWaKreh/LpLPcBmSWZZ4sdFm8PA=" referrerpolicy=no-referrer rel=stylesheet><link crossorigin=anonymous href=/css/paige/bootstrap-icons/bootstrap-icons.min.540116b7267d4b2410c74086ae6497566928c6d5715900be7ce7279ad45addcd.css integrity="sha256-VAEWtyZ9SyQQx0CGrmSXVmkoxtVxWQC+fOcnmtRa3c0=" referrerpolicy=no-referrer rel=stylesheet><link href=https://flowerinthenight.com/categories/code/atom.xml rel=alternate type=application/atom+xml><link href=https://flowerinthenight.com/categories/code/rss.xml rel=alternate type=application/rss+xml><style>#paige-authors,#paige-breadcrumbs,#paige-credit,#paige-date,#paige-file,#paige-keywords,#paige-prev-next,#paige-reading-time,#paige-series,#paige-toc,.paige-authors,.paige-date,.paige-keywords,.paige-reading-time,.paige-series,.paige-summary{display:none}.paige-figure-numbered{counter-increment:paige-figure-numbered}.paige-figure-numbered>div>figure>figcaption::before{content:"Figure " counter(paige-figure-numbered)": "}.paige-figure-numbered>div>figure>figcaption:empty::before{content:"Figure " counter(paige-figure-numbered)}.paige-header-link{opacity:0;margin-left:.5rem;position:absolute;transition:color .15s ease-in-out,opacity .15s ease-in-out}.paige-header-link::after{content:"#"}.paige-quote .blockquote-footer{margin-top:0}.paige-quote blockquote{border-left:0;border-right:0;margin-bottom:0;padding:0}#paige-content>*{margin-bottom:1rem}blockquote{padding:.5rem 1rem;border-left:.25rem solid var(--bs-border-color);border-right:.25rem solid var(--bs-body-bg)}td,th{padding:.25rem}.highlight .chroma .hl,.highlight .chroma .lnt{display:flex}.paige-figure .paige-quote,.paige-figure .paige-video,.paige-figure .highlight pre.chroma,.paige-figure .highlight .chroma pre,.paige-figure .paige-quote blockquote,.paige-figure figure>div>:last-child,.paige-gallery .paige-figure,.paige-gallery .paige-image,blockquote>p:last-of-type{margin-bottom:0}.paige-figure,.paige-gallery,.paige-image,.paige-quote,.paige-video,table{margin-bottom:1rem}.paige-header-link:focus,.paige-header-link:hover,:hover>.paige-header-link,:target>.paige-header-link{opacity:1}@media(prefers-color-scheme:dark){.bg{color:#c9d1d9;background-color:var(--bs-body-bg)}.chroma{color:#c9d1d9;background-color:var(--bs-body-bg)}.chroma .x{}.chroma .err{color:#f85149}.chroma .cl{}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#4f4f4d}.chroma .lnt{white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#64686c}.chroma .ln{white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#6e7681}.chroma .line{display:flex}.chroma .k{color:#ff7b72}.chroma .kc{color:#79c0ff}.chroma .kd{color:#ff7b72}.chroma .kn{color:#ff7b72}.chroma .kp{color:#79c0ff}.chroma .kr{color:#ff7b72}.chroma .kt{color:#ff7b72}.chroma .n{}.chroma .na{}.chroma .nb{}.chroma .bp{}.chroma .nc{color:#f0883e;font-weight:700}.chroma .no{color:#79c0ff;font-weight:700}.chroma .nd{color:#d2a8ff;font-weight:700}.chroma .ni{color:#ffa657}.chroma .ne{color:#f0883e;font-weight:700}.chroma .nf{color:#d2a8ff;font-weight:700}.chroma .fm{}.chroma .nl{color:#79c0ff;font-weight:700}.chroma .nn{color:#ff7b72}.chroma .nx{}.chroma .py{color:#79c0ff}.chroma .nt{color:#7ee787}.chroma .nv{color:#79c0ff}.chroma .vc{}.chroma .vg{}.chroma .vi{}.chroma .vm{}.chroma .l{color:#a5d6ff}.chroma .ld{color:#79c0ff}.chroma .s{color:#a5d6ff}.chroma .sa{color:#79c0ff}.chroma .sb{color:#a5d6ff}.chroma .sc{color:#a5d6ff}.chroma .dl{color:#79c0ff}.chroma .sd{color:#a5d6ff}.chroma .s2{color:#a5d6ff}.chroma .se{color:#79c0ff}.chroma .sh{color:#79c0ff}.chroma .si{color:#a5d6ff}.chroma .sx{color:#a5d6ff}.chroma .sr{color:#79c0ff}.chroma .s1{color:#a5d6ff}.chroma .ss{color:#a5d6ff}.chroma .m{color:#a5d6ff}.chroma .mb{color:#a5d6ff}.chroma .mf{color:#a5d6ff}.chroma .mh{color:#a5d6ff}.chroma .mi{color:#a5d6ff}.chroma .il{color:#a5d6ff}.chroma .mo{color:#a5d6ff}.chroma .o{color:#ff7b72;font-weight:700}.chroma .ow{color:#ff7b72;font-weight:700}.chroma .p{}.chroma .c{color:#8b949e;font-style:italic}.chroma .ch{color:#8b949e;font-style:italic}.chroma .cm{color:#8b949e;font-style:italic}.chroma .c1{color:#8b949e;font-style:italic}.chroma .cs{color:#8b949e;font-weight:700;font-style:italic}.chroma .cp{color:#8b949e;font-weight:700;font-style:italic}.chroma .cpf{color:#8b949e;font-weight:700;font-style:italic}.chroma .g{}.chroma .gd{color:#ffa198;background-color:#490202}.chroma .ge{font-style:italic}.chroma .gr{color:#ffa198}.chroma .gh{color:#79c0ff;font-weight:700}.chroma .gi{color:#56d364;background-color:#0f5323}.chroma .go{color:#8b949e}.chroma .gp{color:#8b949e}.chroma .gs{font-weight:700}.chroma .gu{color:#79c0ff}.chroma .gt{color:#ff7b72}.chroma .gl{text-decoration:underline}.chroma .w{color:#6e7681}}@media(prefers-color-scheme:light){.bg{background-color:#fff}.chroma{background-color:#fff}.chroma .x{}.chroma .err{color:#a61717;background-color:#e3d2d2}.chroma .cl{}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#ffc}.chroma .lnt{white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .line{display:flex}.chroma .k{color:#000;font-weight:700}.chroma .kc{color:#000;font-weight:700}.chroma .kd{color:#000;font-weight:700}.chroma .kn{color:#000;font-weight:700}.chroma .kp{color:#000;font-weight:700}.chroma .kr{color:#000;font-weight:700}.chroma .kt{color:#458;font-weight:700}.chroma .n{}.chroma .na{color:teal}.chroma .nb{color:#0086b3}.chroma .bp{color:#999}.chroma .nc{color:#458;font-weight:700}.chroma .no{color:teal}.chroma .nd{color:#3c5d5d;font-weight:700}.chroma .ni{color:purple}.chroma .ne{color:#900;font-weight:700}.chroma .nf{color:#900;font-weight:700}.chroma .fm{}.chroma .nl{color:#900;font-weight:700}.chroma .nn{color:#555}.chroma .nx{}.chroma .py{}.chroma .nt{color:navy}.chroma .nv{color:teal}.chroma .vc{color:teal}.chroma .vg{color:teal}.chroma .vi{color:teal}.chroma .vm{}.chroma .l{}.chroma .ld{}.chroma .s{color:#d14}.chroma .sa{color:#d14}.chroma .sb{color:#d14}.chroma .sc{color:#d14}.chroma .dl{color:#d14}.chroma .sd{color:#d14}.chroma .s2{color:#d14}.chroma .se{color:#d14}.chroma .sh{color:#d14}.chroma .si{color:#d14}.chroma .sx{color:#d14}.chroma .sr{color:#009926}.chroma .s1{color:#d14}.chroma .ss{color:#990073}.chroma .m{color:#099}.chroma .mb{color:#099}.chroma .mf{color:#099}.chroma .mh{color:#099}.chroma .mi{color:#099}.chroma .il{color:#099}.chroma .mo{color:#099}.chroma .o{color:#000;font-weight:700}.chroma .ow{color:#000;font-weight:700}.chroma .p{}.chroma .c{color:#998;font-style:italic}.chroma .ch{color:#998;font-style:italic}.chroma .cm{color:#998;font-style:italic}.chroma .c1{color:#998;font-style:italic}.chroma .cs{color:#999;font-weight:700;font-style:italic}.chroma .cp{color:#999;font-weight:700;font-style:italic}.chroma .cpf{color:#999;font-weight:700;font-style:italic}.chroma .g{}.chroma .gd{color:#000;background-color:#fdd}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#a00}.chroma .gh{color:#999}.chroma .gi{color:#000;background-color:#dfd}.chroma .go{color:#888}.chroma .gp{color:#555}.chroma .gs{font-weight:700}.chroma .gu{color:#aaa}.chroma .gt{color:#a00}.chroma .gl{text-decoration:underline}.chroma .w{color:#bbb}}@media(prefers-reduced-motion:reduce){.paige-header-link{transition:none}}#paige-content>*{margin-left:auto;margin-right:auto;max-width:60rem}</style></head><body class="d-flex flex-column"><div class="container flex-fill" id=paige-root><div class=row><div class=col><header class=my-3 id=paige-header><p class="display-1 fw-bold mb-2 text-center" id=paige-site-title>f/t</p><nav><ul class="align-items-center justify-content-center nav"><li class=nav-item><a class="nav-link text-decoration-underline" href=/>Home</a></li><li class=nav-item><a class="nav-link text-decoration-underline" href=/blog/>Blog</a></li><li class=nav-item><a class="nav-link text-decoration-underline" href=/bookshelf/>Bookshelf</a></li><li class=nav-item><a class="nav-link text-decoration-underline" href=/tags/>Tags</a></li><li class=nav-item><a class="nav-link text-decoration-underline" href=/search/>Search</a></li></ul></nav><nav aria-label=Breadcrumbs class=mt-3 id=paige-breadcrumbs><div class="d-flex justify-content-center"><ol class="breadcrumb mb-0"><li class=breadcrumb-item><a href=/>About</a></li><li class=breadcrumb-item><a href=/categories/>Categories</a></li></ol></div></nav><script async src="https://www.googletagmanager.com/gtag/js?id=G-EZWHM5C9YT"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EZWHM5C9YT")}</script></header><main class=mt-3 id=paige-main><article class="paige-published paige-term" id=paige-article><div class="align-items-center d-flex flex-column mb-0"><div class=mw-100 id=paige-metadata><h1 class="fw-bold text-center" id=paige-title>Code</h1></div></div></article><div id=paige-pages><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-11-28-ffmpeg-encode-h264mp4/>Encoding .NET bitmaps to H264 using FFMPEG</a></p><p class="mb-0 paige-description text-center">2016-11-28</p><p class="fst-italic mb-0 paige-summary text-center">Recently, I was working on a project that involves the encoding of .NET bitmaps using ffmpeg’s h264 encoder with mp4 as container. This video output will be used in a &lt;video> tag in html5. Sample codes have been all over the place so it took me quite a while to come up with a working solution. The official sample from ffmpeg only encodes to raw h264 stream. This is just a basic sample code for reference.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/c%23/>C#</a> · <a class=link-secondary href=/categories/c++/>C++</a> · <a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-11-28>November 28, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-10-07-cron-like-windows-service-go/>A simple cron-like Windows service</a></p><p class="mb-0 paige-description text-center">2016-10-07</p><p class="fst-italic mb-0 paige-summary text-center">A couple of days ago, I uploaded a generic service in GitHub that has a feature of updating itself. Check out the post here. Today, I uploaded the actual service I’m using in our CI environment, excluding the configuration file.
Check out the source code here.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a> · <a class=link-secondary href=/categories/go/>Go</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-10-07>October 7, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-09-27-windows-delay-update-service-go/>A Windows service with an http endpoint for uploading a new version of itself</a></p><p class="mb-0 paige-description text-center">2016-09-27</p><p class="fst-italic mb-0 paige-summary text-center">Recently, I’ve been working on a service that runs on a lot of VM’s across different locations. If I have a new service build, updating all of the running instances quickly became a bit of a pain. I have to log in to every VM (in some cases through a VPN) and then do a manual upgrade. Now, there are probably tools that already exist for this type of use case but since I’m still learning Go at the moment, I thought this would be a good exercise.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a> · <a class=link-secondary href=/categories/go/>Go</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-09-27>September 27, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-24-rest-client-server-c%23/>A simple REST client/server console app in C#</a></p><p class="mb-0 paige-description text-center">2016-08-24</p><p class="fst-italic mb-0 paige-summary text-center">For personal reference:
Full source code here.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/c%23/>C#</a> · <a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-24>August 24, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-22-syslog-target-go/>Syslog as target in Go logs</a></p><p class="mb-0 paige-description text-center">2016-08-22</p><p class="fst-italic mb-0 paige-summary text-center">For personal reference:
To view syslog in realtime
tail -f /var/log/syslog</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a> · <a class=link-secondary href=/categories/golang/>Golang</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-22>August 22, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-21-log-prefix-fname-go/>Add function name prefix to log.Println in Go</a></p><p class="mb-0 paige-description text-center">2016-08-21</p><p class="fst-italic mb-0 paige-summary text-center">For personal reference:</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a> · <a class=link-secondary href=/categories/golang/>Golang</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-21>August 21, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-20-expvar-gorilla-mux/>How to serve expvar when using gorilla/mux</a></p><p class="mb-0 paige-description text-center">2016-08-20</p><p class="fst-italic mb-0 paige-summary text-center">For personal reference:
Access root http://localhost:8000 Access expvar information http://localhost:8000/debug/vars</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a> · <a class=link-secondary href=/categories/golang/>Golang</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-20>August 20, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-19-dir-cleanup-tool/>Simple directory cleanup tool for Windows (golang)</a></p><p class="mb-0 paige-description text-center">2016-08-19</p><p class="fst-italic mb-0 paige-summary text-center">For personal reference:</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a> · <a class=link-secondary href=/categories/golang/>Golang</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-19>August 19, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-18-git-commands-notes/>My commonly used commands in GIT</a></p><p class="mb-0 paige-description text-center">2016-08-18</p><p class="fst-italic mb-0 paige-summary text-center">Update 2017/03/24: Transferred to a separate repository here.
For personal reference:
Reset a file git checkout HEAD – my-file.txt Delete last commit git reset –hard HEAD~1 Delete local branch git branch -d &lt;branch-name> or to force delete
git branch -D &lt;branch-name> Delete branch from remote repository git push origin –delete &lt;remote-branch-name> Search for the merge commit from a specific commit git log &lt;SHA>..master –ancestry-path –merges Search for a commit message git log | grep &lt;pattern> List commits on range line of codes for one file git blame -L&lt;line#>,+&lt;offset> – &lt;filename> For example, three lines starting from line 257 of main.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-18>August 18, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">2 minutes</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-13-signal-handler-linux-cpp/>A simple signal handler in C/C++ (Linux)</a></p><p class="mb-0 paige-description text-center">2016-08-13</p><p class="fst-italic mb-0 paige-summary text-center">Personal reference:</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-13>August 13, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-08-11-sharing-my-tmux-conf/>Sharing my .tmux.conf</a></p><p class="mb-0 paige-description text-center">2016-08-11</p><p class="fst-italic mb-0 paige-summary text-center">I use tmux heavily and in tandem with vim. Much more so now when it’s supported on Bash on Windows as well. I don’t have to spin up a Linux VM just for the purpose of being my tmux “server”.
Set a Ctrl-b shortcut for reloading tmux config unbind r bind r source-file ~/.tmux.conf # Prefix is Ctrl-a unbind C-b set -g prefix C-a bind C-a send-prefix # Rename terminals set -g set-titles on set -g set-titles-string '#(whoami)@#h@#(curl ipecho.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-08-11>August 11, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-07-27-sharing-my-vimrc/>Sharing my .vimrc</a></p><p class="mb-0 paige-description text-center">2016-07-27</p><p class="fst-italic mb-0 paige-summary text-center">Vim has always been my go to editor/IDE when I’m outside of Visual Studio. Here’s my base _vimrc for Windows.
let mapleader = " " filetype off syntax on colorscheme darkblue " let pc=$PC " if pc == 'HOME' " set guifont=Letter\ Gothic\ Std:h11 " else " set guifont=Lucida\ Sans\ Typewriter:h9 " endif " Save marks to up to 100 files, save global marks as well (f1). To disable, f0 set viminfo='100,f1 " Folding options set foldmethod=indent set foldnestmax=20 set nofoldenable set foldlevel=0 set guifont=Lucida\ Sans\ Typewriter set lines=70 columns=160 set ai set nu set tabstop=4 set shiftwidth=4 set softtabstop=4 set expandtab set wrap set backspace=2 set encoding=utf-8 set fileencodings=utf-8 set nocompatible set noswapfile set shortmess+=I set ignorecase set guioptions-=T set guioptions-=r set guioptions-=m set splitright set splitbelow set ruler set rtp+=$HOME/vimfiles/bundle/Vundle.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-07-27>July 27, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">4 minutes</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-06-13-folder-file-watcher-powershell/>A simple folder/file watcher in Powershell</a></p><p class="mb-0 paige-description text-center">2016-06-13</p><p class="fst-italic mb-0 paige-summary text-center">Personal reference:</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-06-13>June 13, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-05-06-import-environment-powershell/>A simple Powershell function to import an environment</a></p><p class="mb-0 paige-description text-center">2016-05-06</p><p class="fst-italic mb-0 paige-summary text-center">A couple of days ago, I was working on a powershell-based script for mstest automation and I needed to call vsdevcmd.bat from Visual Studio’s tools folder. function Invoke-Environment([Parameter(Mandatory=1)][string]$Command, [switch]$Output, [switch]$Force) { $stream = if ($Output) { ($temp = [IO.Path]::GetTempFileName()) } else { 'nul' } $operator = if ($Force) {'&'} else {'&&'} foreach($_ in cmd /c " $Command > &amp;#34;$stream" 2>&amp;1 $operator SET") { if ($_ -match '^([^=]+)=(.*)') { [System.Environment]::SetEnvironmentVariable($matches[1], $matches[2]) } } if ($Output) { Get-Content -LiteralPath $temp Remove-Item -LiteralPath $temp } } To use the function:</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-05-06>May 6, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-04-06-unzip-function-powershell/>A simple unzip function in Powershell</a></p><p class="mb-0 paige-description text-center">2016-04-06</p><p class="fst-italic mb-0 paige-summary text-center">function UnzipFiles($ZipFileName, $DestDir) { Add-Type -Assembly System.IO.Compression.FileSystem [System.IO.Compression.ZipFile]::ExtractToDirectory($ZipFileName, $DestDir) } To use the function:
UnzipFiles -ZipFileName .\folder\file.zip -DestDir .\destination</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-04-06>April 6, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-04-05-zip-function-powershell/>A simple zip function in Powershell</a></p><p class="mb-0 paige-description text-center">2016-04-05</p><p class="fst-italic mb-0 paige-summary text-center">function ZipFiles($ZipFileName, $SourceDir) { Add-Type -Assembly System.IO.Compression.FileSystem $compressionLevel = [System.IO.Compression.CompressionLevel]::Optimal [System.IO.Compression.ZipFile]::CreateFromDirectory($SourceDir, $ZipFileName, $compressionLevel, $false) } To use the function:
ZipFiles -ZipFileName test.zip -SourceDir .\folder\to\zip</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-04-05>April 5, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-03-22-etw-part6/>[Part 6] Logging with Universal Apps</a></p><p class="mb-0 paige-description text-center">2016-03-22</p><p class="fst-italic mb-0 paige-summary text-center">Check out the codes in GitHub.
Basically, 2 steps:
Create a C++ Windows Runtime Component (dll) that will use the ETW header file. Reference the WinRT DLL to C# project.
WinRT DLL My logging class looks like this:
public ref class TraceCore sealed { private: TraceCore(); ~TraceCore(); static TraceCore^ m_Instance; public: static property TraceCore^ Instance { TraceCore^ get() { if (m_Instance == nullptr) { m_Instance = ref new TraceCore(); } return m_Instance; } } void Verbose(Platform::String^ mod, Platform::String^ file, Platform::String^ func, Platform::String^ m); }; And heres the implementation:</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-03-22>March 22, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-03-19-etw-part5/>[Part 5] Logging with C# applications</a></p><p class="mb-0 paige-description text-center">2016-03-19</p><p class="fst-italic mb-0 paige-summary text-center">Check out the codes in GitHub. I generated a C# logging class using this command: mc -css &lt;Namespace_here> jytrace.man So far, most of my event templates use an ANSI string data type which (I believe) is not supported by C#. As you can see in part 1, I use ANSI data type for my File and Function fields so that I can use FILE and FUNCTION as inputs in C++. Thats why I added a new event template with all fields using UNICODE data types.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-03-19>March 19, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-03-07-etw-part4/>[Part 4] Log collection</a></p><p class="mb-0 paige-description text-center">2016-03-07</p><p class="fst-italic mb-0 paige-summary text-center">Check out the codes in GitHub.
Getting the logs Now that I have my modules spitting out logs for me, it’s time to actually consume (or view) them. Most of the time, I use MFTrace and logman tools.
MFTrace Although MFTrace is primarily a tool for generating logs for Media Foundation apps, it is a great tool for viewing ETW logs in general as well. It is included in the MS SDK.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-03-07>March 7, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">2 minutes</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-03-03-etw-part3/>[Part 3] Logging with C/C++ applications</a></p><p class="mb-0 paige-description text-center">2016-03-03</p><p class="fst-italic mb-0 paige-summary text-center">Check out the codes in GitHub. If you remember in part 2, we compiled our manifest file with mc -um &lt;manifest_file>.man and we got a header file as one of the outputs. We just have to include that header file to our sources and we are good to go. #include … #include "&lt;manifest_file>.h" int main(…) { EventRegister&lt;provider_name_in_manifest>(); … CreateFile(…); // Example of using the LastError event in our manifest file EventWriteLastError(L"THIS_EXE", FILE, FUNC, L"CreateFile", GetLastError()); .</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-03-03>March 3, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-03-02-etw-part2/>[Part 2] Manifest file compilation and setup</a></p><p class="mb-0 paige-description text-center">2016-03-02</p><p class="fst-italic mb-0 paige-summary text-center">Check out the codes in GitHub.
Compiling the manifest file This is how I compiled my manifest file.
Open Visual Studio command prompt. Compile manifest file. mc -um &lt;manifest_file>.man When successful, output files are:
&lt;filename>.h &lt;filename>.rc &lt;filename>TEMP.BIN MSG00001.bin Creating the message resource DLL I like to create a separate dll just for the manifest file resource although you can also add the .rc file to any of your existing dll or exe.</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-03-02>March 2, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">1 minute</p></div><div class="mb-3 paige-page paige-published w-100"><p class="mb-0 paige-title text-center"><a href=/blog/2016-03-01-etw-part1/>[Part 1] How I set up ETW for logging (native, .NET, Metro and UApp)</a></p><p class="mb-0 paige-description text-center">2016-03-01</p><p class="fst-italic mb-0 paige-summary text-center">Check out the codes in GitHub.
Ive been using ETW as my go-to logging mechanism for Windows development. I will be sharing how I setup my environment here.
Creating the manifest file (.man) I use ecmangen.exe to create my manifest file. This tool is included in the SDK. I have Visual Studio 2015 installed on a Win10 64-bit machine, and its location is C:\Program Files (x86)\Windows Kits\10\bin\x64. It looks something like this (my completed manifest):</p><p class="mb-0 paige-keywords text-center text-secondary"><a class=link-secondary href=/categories/code/>Code</a></p><p class="mb-0 paige-date text-center text-secondary"><time datetime=2016-03-01>March 1, 2016</time></p><p class="mb-0 paige-reading-time text-center text-secondary">3 minutes</p></div></div></main><footer class=mb-3 id=paige-footer><p class="mb-0 text-center text-secondary" id=paige-copyright>© Flowerinthenight, 2016-2024. All rights reserved.</p><p class="mb-0 text-center" id=paige-credit><a class="link-secondary text-decoration-none" href=https://github.com/willfaught/paige>Paige Theme</a></p></footer></div></div></div><script crossorigin=anonymous defer integrity="sha256-gfPiYYSP+RNtNeRBt45mJombFJmNf0V0Ipu785Obi0M=" referrerpolicy=no-referrer src=/js/paige/bootstrap/bootstrap.bundle.min.81f3e261848ff9136d35e441b78e6626899b14998d7f4574229bbbf3939b8b43.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EZWHM5C9YT"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EZWHM5C9YT")}</script><noscript>JavaScript is required</noscript></body></html>